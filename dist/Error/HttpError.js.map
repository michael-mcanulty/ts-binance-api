{"version":3,"file":"HttpError.js","sourceRoot":"","sources":["../../src/Error/HttpError.ts"],"names":[],"mappings":"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","sourcesContent":["import {EErrorType} from \"./Email/Enums/EErrorType\";\nimport {BinanceError} from \"./BinanceError\";\nimport {HttpErrorHandler} from \"./HttpErrorHandler\";\n\nexport class HttpError extends Error {\n\tpublic static binanceErrors: HttpError[] = [\n\t\tnew HttpError(-1000, \"UNKNOWN\"),\n\t\tnew HttpError(-1001, \"DISCONNECTED\"),\n\t\tnew HttpError(-1002, \"UNAUTHORIZED\"),\n\t\tnew HttpError(-1003, \"TOO_MANY_REQUESTS\"),\n\t\tnew HttpError(-1006, \"UNEXPECTED_RESP\"),\n\t\tnew HttpError(-1007, \"TIMEOUT\"),\n\t\tnew HttpError(-1013, \"INVALID_MESSAGE\"),\n\t\tnew HttpError(-1014, \"UNKNOWN_ORDER_COMPOSITION\"),\n\t\tnew HttpError(-1015, \"TOO_MANY_ORDERS\"),\n\t\tnew HttpError(-1016, \"SERVICE_SHUTTING_DOWN\"),\n\t\tnew HttpError(-1020, \"UNSUPPORTED_OPERATION\"),\n\t\tnew HttpError(-1021, \"INVALID_TIMESTAMP\"),\n\t\tnew HttpError(-1022, \"INVALID_SIGNATURE\"),\n\t\tnew HttpError(-1100, \"ILLEGAL_CHARS\"),\n\t\tnew HttpError(-1101, \"TOO_MANY_PARAMETERS\"),\n\t\tnew HttpError(-1102, \"MANDATORY_PARAM_EMPTY_OR_MALFORMED\"),\n\t\tnew HttpError(-1103, \"UNKNOWN_PARAM\"),\n\t\tnew HttpError(-1104, \"UNREAD_PARAMETERS\"),\n\t\tnew HttpError(-1105, \"PARAM_EMPTY\"),\n\t\tnew HttpError(-1106, \"PARAM_NOT_REQUIRED\"),\n\t\tnew HttpError(-1130, \"INVALID_PARAMETER\"),\n\t\tnew HttpError(-2008, \"BAD_API_ID\"),\n\t\tnew HttpError(-2009, \"DUPLICATE_API_KEY_DESC\"),\n\t\tnew HttpError(-2010, \"INSUFFICIENT_BALANCE\"),\n\t\tnew HttpError(-2012, \"CANCEL_ALL_FAIL\"),\n\t\tnew HttpError(-2013, \"NO_SUCH_ORDER\"),\n\t\tnew HttpError(-2014, \"BAD_API_KEY_FMT\"),\n\t\tnew HttpError(-2015, \"REJECTED_MBX_KEY\")\n\t];\n\tcode: number;\n\thandler?: HttpErrorHandler;\n\tmessage: string;\n\n\tprivate static _getErrorByCode(code: number): HttpError {\n\t\tlet result: HttpError;\n\t\tif (HttpError.binanceErrors.length > 0) {\n\t\t\tlet filtered: HttpError[] = HttpError.binanceErrors.filter(handler => handler.code === code);\n\t\t\tif (filtered && filtered.length > 0) {\n\t\t\t\tresult = filtered[0];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate static _getErrorParameters(err: BinanceError | HttpError): {code: number, message: string}{\n\t\tlet code: number = parseInt(err.code.toString());\n\t\tlet type: EErrorType = HttpError._getErrorType(err);\n\t\tlet message: string = (type === EErrorType.Binance) ? err['msg'] : err['message'];\n\t\treturn {code: code, message: message};\n\t}\n\n\tprivate static _getErrorType(err: BinanceError | HttpError): EErrorType {\n\t\t//parseInt(code.toString());\n\t\tlet code: number = parseInt(err.code.toString());\n\t\tlet isBinance: boolean = false;\n\t\tif (typeof err['msg'] === \"string\" && code < 0) {\n\t\t\tisBinance = true;\n\t\t} else if (typeof err['message'] === \"string\") {\n\t\t\tisBinance = false;\n\t\t}\n\t\treturn (isBinance) ? EErrorType.Binance : EErrorType.Node;\n\t}\n\n\tpublic static GetTimeoutFromIPBannedMsg(err: BinanceError): number {\n\t\tlet strFloat: string;\n\t\tlet result: number = 0;\n\t\tif (err && err.msg) {\n\t\t\tlet msg: string = \"IP banned until \";\n\t\t\tlet startIdx = err.msg.indexOf(msg) + msg.length;\n\t\t\tlet float = parseFloat(err.msg.slice(startIdx, startIdx + 13));\n\t\t\tstrFloat = float.toString();\n\t\t\tif (strFloat.length === 13) {\n\t\t\t\tresult = float - new Date().getTime();\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic static fromError(err: HttpError|BinanceError): HttpError{\n\t\tlet code: number = parseInt(err.code.toString());\n\t\tlet type: EErrorType = HttpError._getErrorType(err);\n\t\tlet message: string = (type === EErrorType.Binance) ? err['msg'] : err['message'];\n\t\tlet _httpError: HttpError = new HttpError(code, message);\n\t\tif(type === EErrorType.Binance && typeof err['handler']===\"object\"){\n\t\t\t_httpError.handler = err['handler'];\n\t\t}\n\t\treturn _httpError;\n\t}\n\n\tconstructor(code: number, message: string, handler?:HttpErrorHandler) {\n\t\tsuper();\n\t\tthis.code = code;\n\t\tthis.message = message;\n\t\tif (handler) {\n\t\t\tthis.handler = handler;\n\t\t\t(async()=>{\n\t\t\t\tawait this.handler.handleError(code, message);\n\t\t\t})()\n\t\t}\n\t}\n}\n"]}