{"version":3,"file":"HttpErrorHandler.js","sourceRoot":"","sources":["../../src/Error/HttpErrorHandler.ts"],"names":[],"mappings":"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","sourcesContent":["import {EMethod} from \"../Rest/EMethod\";\nimport {BotHttp} from \"../Rest/BotHttp\";\nimport {NodeMailer} from \"./Email/NodeMailer\";\nimport {IEmailOptions} from \"./Email/Interfaces/IServiceOprtions\";\nimport {IMessageOptions} from \"./Email/Interfaces/IMessageOptions\";\nimport {EErrorType} from \"./Email/Enums/EErrorType\";\n\nexport class HttpErrorHandler {\n\tprivate static _emailService: NodeMailer;\n\tpublic static allErrors: HttpErrorHandler[] = [\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\tnew HttpErrorHandler(EMethod.GET, EErrorType.Binance, 4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\")\n\t];\n\tstatic emailOptions?: IEmailOptions;\n\tendpoint?: string;\n\tmethod?: string;\n\tpayload?: any[];\n\tport?: number;\n\trecipientEmail?: string;\n\tsendEmail?: boolean;\n\ttype?: string;\n\n\tprivate readonly _url?: string;\n\n\tget url(): string {\n\t\treturn `${this.endpoint}:${this.port}`\n\t}\n\n\thandleError(code: number, message: string): Promise<any> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tif (this.port !== null && this.method !== null) {\n\t\t\t\tlet url: string = this._url;\n\t\t\t\tlet reqOpts: RequestInit = <RequestInit>{};\n\t\t\t\treqOpts.method = EMethod[this.method];\n\t\t\t\treqOpts.headers = new Headers();\n\n\t\t\t\tif (this.payload && this.payload.length > 0) {\n\t\t\t\t\turl = BotHttp.buildUrl(this._url, false, this.payload);\n\t\t\t\t}\n\n\t\t\t\tif (this.sendEmail && HttpErrorHandler.emailOptions) {\n\t\t\t\t\tlet msgOptions: IMessageOptions = <IMessageOptions>{};\n\t\t\t\t\tHttpErrorHandler._emailService = new NodeMailer(HttpErrorHandler.emailOptions);\n\t\t\t\t\tmsgOptions.from = this.recipientEmail;\n\t\t\t\t\tmsgOptions.to = this.recipientEmail;\n\t\t\t\t\tmsgOptions.subject = `A new ${EErrorType[this.type] || \"Unknown\"} error has been received | ${message}`;\n\t\t\t\t\tmsgOptions.text = `${new Date().toLocaleDateString()} : \\n Code: ${code} \\n Message: ${message}`;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait HttpErrorHandler._emailService.sendEmail(msgOptions);\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tlet fetch: any = {};\n\t\t\t\t\t//fetch = await BotHttp.fetch(url, reqOpts);\n\t\t\t\t\tresolve(fetch);\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tconstructor(\n\t\tmethod?: EMethod,\n\t\ttype?: EErrorType,\n\t\tport?: number,\n\t\tsendEmail?: boolean,\n\t\tendpoint?: string,\n\t\trecipientEmail?: string\n\t) {\n\t\tthis.method = EMethod[method] || EMethod[EMethod.GET];\n\t\tthis.type = EErrorType[type] || EErrorType[EErrorType.Binance];\n\n\t\tthis.port = port || 4001;\n\t\tthis.sendEmail = sendEmail || false;\n\t\tthis.endpoint = endpoint || \"http://localhost\";\n\t\tthis.recipientEmail = recipientEmail;\n\n\t\tif (this.endpoint && this.port) {\n\t\t\tthis._url = `${this.endpoint}:${this.port}`;\n\t\t} else {\n\t\t\tthis._url = null;\n\t\t}\n\t}\n}\n"]}