{"version":3,"file":"ErrorHandler.js","sourceRoot":"","sources":["../../src/Error/ErrorHandler.ts"],"names":[],"mappings":"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","sourcesContent":["import {EMethod} from \"../Rest/EMethod\";\nimport {BotHttp} from \"../Rest/BotHttp\";\nimport {NodeMailer} from \"./Email/NodeMailer\";\nimport {IEmailOptions} from \"./Email/Interfaces/IServiceOprtions\";\nimport {IMessageOptions} from \"./Email/Interfaces/IMessageOptions\";\nimport {EErrorType} from \"./Email/Enums/EErrorType\";\n\nexport class ErrorHandler {\n\tprivate static _emailService: NodeMailer;\n\tpublic static allErrors: ErrorHandler[] = [\n\t\t\tnew ErrorHandler(-1000, \"UNKNOWN\" , EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\t  new ErrorHandler(-1001, \"DISCONNECTED\" , EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\t  new ErrorHandler(-1002, \"UNAUTHORIZED\" , EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\t  new ErrorHandler(-1003, \"TOO_MANY_REQUESTS\" , EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\t  new ErrorHandler(-1006, \"UNEXPECTED_RESP\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t  \tnew ErrorHandler(-1007, \"TIMEOUT\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\t  new ErrorHandler(-1013, \"INVALID_MESSAGE\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t\t  new ErrorHandler(-1014, \"UNKNOWN_ORDER_COMPOSITION\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\t  \tnew ErrorHandler(-1015, \"TOO_MANY_ORDERS\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1016, \"SERVICE_SHUTTING_DOWN\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1020, \"UNSUPPORTED_OPERATION\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1021, \"INVALID_TIMESTAMP\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1022, \"INVALID_SIGNATURE\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1100, \"ILLEGAL_CHARS\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1101, \"TOO_MANY_PARAMETERS\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1102, \"MANDATORY_PARAM_EMPTY_OR_MALFORMED\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1103, \"UNKNOWN_PARAM\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1104, \"UNREAD_PARAMETERS\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1105, \"PARAM_EMPTY\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1106, \"PARAM_NOT_REQUIRED\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-1130, \"INVALID_PARAMETER\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-2008, \"BAD_API_ID\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-2009, \"DUPLICATE_API_KEY_DESC\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-2010, \"INSUFFICIENT_BALANCE\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-2012, \"CANCEL_ALL_FAIL\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-2013, \"NO_SUCH_ORDER\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-2014, \"BAD_API_KEY_FMT\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\"),\n\tnew ErrorHandler(-2015, \"REJECTED_MBX_KEY\", EMethod.GET, EErrorType.Binance,4001, false, \"http://localhost\", \"michael.mcanulty88@gmail.com\")\n\t];\n\tstatic emailOptions?: IEmailOptions;\n\tmethod: string;\n\ttype: string;\n\tendpoint?: string;\n\tpayload?: any[];\n\tport?: number;\n\trecipientEmail?: string;\n\tsendEmail?: boolean;\n\turl?: string;\n\n\thandleError(code: number, message: string): Promise<any> {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tif (this.port !== null && this.method !== null) {\n\t\t\t\tlet url: string = this.url;\n\t\t\t\tlet reqOpts: RequestInit = <RequestInit>{};\n\t\t\t\treqOpts.method = EMethod[this.method];\n\t\t\t\treqOpts.headers = new Headers();\n\n\t\t\t\tif (this.payload && this.payload.length > 0) {\n\t\t\t\t\turl = BotHttp.buildUrl(this.url, false, this.payload);\n\t\t\t\t}\n\n\t\t\t\tif (this.sendEmail && ErrorHandler.emailOptions) {\n\t\t\t\t\tErrorHandler._emailService = new NodeMailer(ErrorHandler.emailOptions);\n\t\t\t\t\tlet msgOptions: IMessageOptions = <IMessageOptions>{};\n\t\t\t\t\tmsgOptions.from = this.recipientEmail;\n\t\t\t\t\tmsgOptions.to = this.recipientEmail;\n\t\t\t\t\tmsgOptions.subject = `A new ${EErrorType[this.type] || \"Unknown\"} error has been received | ${message}`;\n\t\t\t\t\tmsgOptions.text = `${new Date().toLocaleDateString()} : \\n Code: ${code} \\n Message: ${message}`;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait ErrorHandler._emailService.sendEmail(msgOptions);\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tlet fetch: any = {};\n\t\t\t\t\t//fetch = await BotHttp.fetch(url, reqOpts);\n\t\t\t\t\tresolve(fetch);\n\t\t\t\t} catch (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tconstructor(\n\t\tcode: number,\n\t\tmessage: string,\n\t\tmethod: EMethod,\n\t\ttype: EErrorType,\n\n\t\tport: number,\n\t\tsendEmail: boolean,\n\t\tendpoint: string,\n\t\trecipientEmail?: string\n\t) {\n\t\tthis.method = EMethod[method];\n\t\tthis.type = EErrorType[type];\n\n\t\tthis.port = port;\n\t\tthis.sendEmail = sendEmail || false;\n\t\tthis.endpoint = endpoint;\n\t\tthis.recipientEmail = recipientEmail;\n\n\t\tif(this.endpoint && this.port){\n\t\t\tthis.url = `${this.endpoint}:${this.port}`;\n\t\t}else{\n\t\t\tthis.url = null;\n\t\t}\n\t}\n}\n"]}