"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const NodeMailer_1=require("../Error/NodeMailer");class TextMessage{constructor(e,t){if(this.msgOptions={},!(t&&t.auth&&t.auth.user&&t.auth.pass))throw new Error("Creating a new TextMessage requires email options with a username and password.");this.msgOptions.from=t.auth.user,this.smtpOptions=t,this.carrier=e;let s=TextMessage.USCarriers.filter(t=>t.name===e);if(!(s&&s.length>0))throw new Error(`${e} not found`);{let e=s[0];this.domain=e.domain,this.carrier=e.name}this._mailService=new NodeMailer_1.NodeMailer(this.smtpOptions)}_getCarrierEmailAddress(e){return`${e}@${this.domain}`}async send(e,t,s){let i;try{return this.msgOptions.to=this._getCarrierEmailAddress(s),this.msgOptions.subject=t,this.msgOptions.text=t,i=await this._mailService.sendEmail(this.msgOptions)}catch(e){throw e}}async sendError(e,t,s){let i,a,r;e&&(this.msgOptions.text=e.message,this.msgOptions.subject=`${a?"Fatal":""}${r?e.handler.type:"Unknown"} Error Received`,"boolean"!=typeof e.isFatal&&"function"!=typeof e.handler||(a=e.isFatal,r=!!e.handler.type),s&&(i=`\nSource: ${s}`,this.msgOptions.text+=i),await this.send(this.msgOptions.subject,this.msgOptions.text,t))}}TextMessage.USCarriers=[{name:"att",domain:"txt.att.net"},{name:"tmobile",domain:"tmomail.net"},{name:"verizon",domain:"vtext.com"},{name:"cricket",domain:"sms.mycricket.com"},{name:"uscellular",domain:"email.uscc.net"},{name:"virginmobile",domain:"vmobl.com"},{name:"boostmobile",domain:"myboostmobile.com"},{name:"metropcs",domain:"mymetropcs.com"}],exports.TextMessage=TextMessage;